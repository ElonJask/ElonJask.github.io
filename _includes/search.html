{% assign search_is_en = false %}
{% if page.collection == 'posts_en' or page.lang == 'en-US' or page.lang == 'en' or page.url contains '/en/' %}
  {% assign search_is_en = true %}
{% endif %}
{% if search_is_en %}
  {% assign search_placeholder = "Search posts..." %}
  {% assign search_empty_text = "Type to search posts..." %}
  {% assign search_loading_text = "Loading search index..." %}
  {% assign search_no_results = "No matching posts found" %}
  {% assign search_error_text = "Failed to load search index" %}
  {% assign search_close_label = "Close search" %}
  {% assign search_tip_open = "to search" %}
  {% assign search_tip_close = "to close" %}
  {% assign search_tip_nav = "to navigate" %}
  {% assign search_tip_select = "to select" %}
  {% assign search_tag_label = "Tags" %}
{% else %}
  {% assign search_placeholder = "搜索文章..." %}
  {% assign search_empty_text = "输入关键词搜索文章..." %}
  {% assign search_loading_text = "正在加载搜索索引..." %}
  {% assign search_no_results = "没有找到匹配文章" %}
  {% assign search_error_text = "搜索索引加载失败" %}
  {% assign search_close_label = "关闭搜索" %}
  {% assign search_tip_open = "唤起搜索" %}
  {% assign search_tip_close = "关闭" %}
  {% assign search_tip_nav = "切换结果" %}
  {% assign search_tip_select = "打开结果" %}
  {% assign search_tag_label = "标签" %}
{% endif %}

<!-- Search Modal -->
<div
  id="search-modal"
  class="search-modal"
  aria-hidden="true"
  role="dialog"
  aria-label="{{ search_placeholder }}"
  data-empty-text="{{ search_empty_text }}"
  data-loading-text="{{ search_loading_text }}"
  data-no-results-text="{{ search_no_results }}"
  data-error-text="{{ search_error_text }}"
  data-tag-label="{{ search_tag_label }}"
  data-source="{{ '/search.json' | relative_url }}"
>
  <div class="search-container">
    <div class="search-header">
      <input
        type="search"
        id="search-input"
        class="search-input"
        placeholder="{{ search_placeholder }}"
        aria-label="{{ search_placeholder }}"
        autocomplete="off"
      >
      <button class="search-close" id="search-close" aria-label="{{ search_close_label }}">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M15 5L5 15M5 5L15 15" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
    </div>
    <div id="search-results" class="search-results" role="listbox"></div>
    <div class="search-footer">
      <div class="search-tips">
        <kbd>/</kbd> {{ search_tip_open }}
        <kbd>ESC</kbd> {{ search_tip_close }}
        <kbd>↑↓</kbd> {{ search_tip_nav }}
        <kbd>Enter</kbd> {{ search_tip_select }}
      </div>
    </div>
  </div>
</div>
